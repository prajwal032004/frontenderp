{% extends "intern_base.html" %} {% block title %}My Goals{% endblock %} {%
block page_title %}Professional Goals{% endblock %} {% block content %}
<div x-data="{ showGoalModal: false, editMode: false, currentGoal: {} }">
  <!-- Header -->
  <div
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    "
  >
    <p style="color: var(--text-muted)">
      Track your learning and project milestones.
    </p>
    <button
      @click="showGoalModal = true; editMode = false"
      class="btn"
      style="
        background: var(--primary);
        color: white;
        padding: 10px 20px;
        border-radius: 50px;
        border: none;
        font-weight: 600;
      "
    >
      <i class="fas fa-plus"></i> New Goal
    </button>
  </div>

  <!-- Goals Grid -->
  <div
    style="
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem;
    "
  >
    {% for goal in goals %}
    <div
      class="glass-panel"
      style="padding: 1.5rem; border-radius: 16px; position: relative"
    >
      <div
        style="
          display: flex;
          justify-content: space-between;
          margin-bottom: 0.5rem;
        "
      >
        <h3 style="font-size: 1.1rem; font-weight: 600">{{ goal.title }}</h3>
        <span style="font-size: 0.8rem; color: var(--text-muted)"
          >{{ goal.target_date }}</span
        >
      </div>

      <p
        style="
          color: var(--text-muted);
          font-size: 0.9rem;
          margin-bottom: 1.5rem;
          min-height: 40px;
        "
      >
        {{ goal.description }}
      </p>

      <!-- Progress Bar -->
      <div style="margin-bottom: 1rem">
        <div
          style="
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 5px;
          "
        >
          <span>Progress</span>
          <span>{{ goal.progress }}%</span>
        </div>
        <div
          style="
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
          "
        >
          <div
            style="height: 100%; width: {{ goal.progress }}%; background: var(--primary); border-radius: 4px;"
          ></div>
        </div>
      </div>

      <!-- Update Form (Mini) -->
      <form
        action="{{ url_for('update_goal', goal_id=goal.id) }}"
        method="POST"
        style="
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid rgba(255, 255, 255, 0.05);
          display: flex;
          gap: 10px;
        "
      >
        <input
          type="number"
          name="progress"
          min="0"
          max="100"
          placeholder="%"
          value="{{ goal.progress }}"
          style="
            width: 60px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--glass-border);
            color: white;
            border-radius: 8px;
            padding: 5px;
            text-align: center;
          "
        />
        <select
          name="status"
          style="
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--glass-border);
            color: white;
            border-radius: 8px;
            padding: 5px;
            flex: 1;
          "
        >
          <option
            value="IN_PROGRESS"
            {%
            if
            goal.status=""
            ="IN_PROGRESS"
            %}selected{%
            endif
            %}
          >
            In Progress
          </option>
          <option
            value="COMPLETED"
            {%
            if
            goal.status=""
            ="COMPLETED"
            %}selected{%
            endif
            %}
          >
            Completed
          </option>
        </select>
        <button
          type="submit"
          class="icon-btn"
          style="width: 32px; height: 32px; font-size: 0.8rem"
        >
          <i class="fas fa-save"></i>
        </button>
      </form>
    </div>
    {% endfor %}
  </div>

  <!-- Modal -->
  <div
    x-show="showGoalModal"
    class="security-modal"
    style="display: flex"
    x-cloak
  >
    <div
      class="glass-panel"
      style="
        width: 100%;
        max-width: 500px;
        padding: 2rem;
        border-radius: 20px;
        background: var(--bg-body);
      "
      @click.away="showGoalModal = false"
    >
      <h3 style="margin-bottom: 1.5rem">Set New Goal</h3>
      <form action="{{ url_for('intern_goals') }}" method="POST">
        <div style="margin-bottom: 1rem">
          <label
            style="display: block; margin-bottom: 5px; color: var(--text-muted)"
            >Title</label
          >
          <input
            type="text"
            name="title"
            required
            style="
              width: 100%;
              padding: 10px;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid var(--glass-border);
              border-radius: 8px;
              color: var(--text-main);
            "
          />
        </div>
        <div style="margin-bottom: 1rem">
          <label
            style="display: block; margin-bottom: 5px; color: var(--text-muted)"
            >Description</label
          >
          <textarea
            name="description"
            rows="3"
            style="
              width: 100%;
              padding: 10px;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid var(--glass-border);
              border-radius: 8px;
              color: var(--text-main);
            "
          ></textarea>
        </div>
        <div style="margin-bottom: 1.5rem">
          <label
            style="display: block; margin-bottom: 5px; color: var(--text-muted)"
            >Target Date</label
          >
          <input
            type="date"
            name="target_date"
            required
            style="
              width: 100%;
              padding: 10px;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid var(--glass-border);
              border-radius: 8px;
              color: var(--text-main);
            "
          />
        </div>
        <div style="display: flex; justify-content: flex-end; gap: 1rem">
          <button
            type="button"
            @click="showGoalModal = false"
            style="
              padding: 8px 16px;
              background: transparent;
              color: var(--text-muted);
              border: 1px solid var(--glass-border);
              border-radius: 8px;
            "
          >
            Cancel
          </button>
          <button
            type="submit"
            style="
              padding: 8px 24px;
              background: var(--primary);
              color: white;
              border: none;
              border-radius: 8px;
            "
          >
            Create Goal
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
