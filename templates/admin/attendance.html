{% extends "admin_base.html" %} {% block title %}Attendance Logs{% endblock %}
{% block page_title %}Attendance Monitor{% endblock %} {% block content %}
<div
  style="
    display: flex;
    justify-content: space-between;
    align-items: end;
    margin-bottom: 2rem;
  "
>
  <form
    action="{{ url_for('admin_attendance') }}"
    method="GET"
    style="display: flex; gap: 1rem"
  >
    <div>
      <label
        style="
          color: var(--text-muted);
          font-size: 0.8rem;
          display: block;
          margin-bottom: 5px;
        "
        >Select Date</label
      >
      <input
        type="date"
        name="date"
        value="{{ request.args.get('date', '') }}"
        style="
          padding: 10px;
          background: rgba(0, 0, 0, 0.2);
          border: 1px solid var(--glass-border);
          border-radius: 8px;
          color: white;
        "
      />
    </div>
    <button
      type="submit"
      class="btn"
      style="
        background: var(--primary);
        color: black;
        height: fit-content;
        align-self: end;
      "
    >
      View
    </button>
  </form>

  <div class="dropdown" x-data="{ open: false }" style="position: relative">
    <button
      @click="open = !open"
      class="btn"
      style="
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
      "
    >
      <i class="fas fa-file-csv"></i> Export Data
    </button>
    <div
      x-show="open"
      @click.away="open = false"
      class="custom-dropdown"
      x-cloak
    >
      <a
        href="{{ url_for('export_attendance_csv', month='current') }}"
        class="dropdown-item"
        >Export This Month</a
      >
      <a
        href="{{ url_for('export_attendance_summary_csv', month='current') }}"
        class="dropdown-item"
        >Export Summary</a
      >
    </div>
  </div>
</div>

<div class="glass-panel" style="padding: 0; overflow: hidden">
  <table style="width: 100%; border-collapse: collapse">
    <thead>
      <tr style="background: rgba(255, 255, 255, 0.05); text-align: left">
        <th style="padding: 1rem">Date</th>
        <th style="padding: 1rem">Intern</th>
        <th style="padding: 1rem">In Time</th>
        <th style="padding: 1rem">Out Time</th>
        <th style="padding: 1rem">Duration</th>
        <th style="padding: 1rem">Location</th>
      </tr>
    </thead>
    <tbody>
      {% if logs %} {% for log in logs %}
      <tr style="border-bottom: 1px solid var(--glass-border)">
        <td style="padding: 1rem">{{ log.date }}</td>
        <td style="padding: 1rem; font-weight: 600">{{ log.intern_name }}</td>
        <td
          style="padding: 1rem; font-family: monospace; color: var(--success)"
        >
          {{ log.in_time }}
        </td>
        <td style="padding: 1rem; font-family: monospace; color: var(--danger)">
          {{ log.out_time or '--:--' }}
        </td>
        <td style="padding: 1rem">{{ log.duration }}</td>
        <td style="padding: 1rem; color: var(--text-muted); font-size: 0.9rem">
          {{ log.location }}
        </td>
      </tr>
      {% endfor %} {% else %}
      <tr>
        <td colspan="6" style="padding: 2rem; text-align: center">
          No attendance records found for this selection.
        </td>
      </tr>
      {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
