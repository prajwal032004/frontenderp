{% extends "admin_base.html" %}
{% block title %}Manage Interns{% endblock %}
{% block page_title %}Intern Directory{% endblock %}

{% block content %}
<div class="glass-panel" style="padding: 1.5rem; margin-bottom: 2rem;">
    <form action="{{ url_for('admin_interns') }}" method="GET" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div>
            <label style="color: var(--text-muted); font-size: 0.8rem; display: block; margin-bottom: 5px;">Search</label>
            <input type="text" name="search" placeholder="Name, Email or ID..." value="{{ request.args.get('search', '') }}" 
                   style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
        </div>
        <div>
            <label style="color: var(--text-muted); font-size: 0.8rem; display: block; margin-bottom: 5px;">Department</label>
            <select name="department" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                <option value="all">All Departments</option>
                <option value="IT" {% if request.args.get('department') == 'IT' %}selected{% endif %}>IT</option>
                <option value="HR" {% if request.args.get('department') == 'HR' %}selected{% endif %}>HR</option>
                <option value="Marketing" {% if request.args.get('department') == 'Marketing' %}selected{% endif %}>Marketing</option>
            </select>
        </div>
        <div>
            <label style="color: var(--text-muted); font-size: 0.8rem; display: block; margin-bottom: 5px;">Status</label>
            <select name="status" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                <option value="all">All Status</option>
                <option value="APPROVED" {% if request.args.get('status') == 'APPROVED' %}selected{% endif %}>Active</option>
                <option value="PENDING" {% if request.args.get('status') == 'PENDING' %}selected{% endif %}>Pending</option>
            </select>
        </div>
        <div style="display: flex; align-items: end;">
            <button type="submit" class="btn" style="background: var(--primary); color: black; width: 100%; padding: 10px;"><i class="fas fa-filter"></i> Filter</button>
        </div>
    </form>
</div>

<div class="glass-panel" style="padding: 0; overflow: hidden;">
    <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
        <thead>
            <tr style="background: rgba(255,255,255,0.05); text-align: left;">
                <th style="padding: 1rem; color: var(--text-muted);">Profile</th>
                <th style="padding: 1rem; color: var(--text-muted);">Details</th>
                <th style="padding: 1rem; color: var(--text-muted);">Department</th>
                <th style="padding: 1rem; color: var(--text-muted);">Status</th>
                <th style="padding: 1rem; color: var(--text-muted);">Action</th>
            </tr>
        </thead>
        <tbody>
            {% if interns %}
                {% for user in interns %}
                <tr style="border-bottom: 1px solid var(--glass-border);">
                    <td style="padding: 1rem;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="{{ user.photo_url or 'https://ui-avatars.com/api/?name=' + user.full_name }}" style="width: 40px; height: 40px; border-radius: 50%;">
                            <div>
                                <div style="font-weight: 600;">{{ user.full_name }}</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">{{ user.intern_id }}</div>
                            </div>
                        </div>
                    </td>
                    <td style="padding: 1rem;">
                        <div style="font-size: 0.9rem;">{{ user.email }}</div>
                        <div style="font-size: 0.8rem; color: var(--text-muted);">{{ user.phone }}</div>
                    </td>
                    <td style="padding: 1rem;">
                        <span style="background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 4px; font-size: 0.8rem;">{{ user.department }}</span>
                    </td>
                    <td style="padding: 1rem;">
                        {% if user.status == 'APPROVED' %}
                            <span style="color: var(--success); font-size: 0.9rem;"><i class="fas fa-check-circle"></i> Active</span>
                        {% else %}
                            <span style="color: #f59e0b; font-size: 0.9rem;"><i class="fas fa-clock"></i> Pending</span>
                        {% endif %}
                    </td>
                    <td style="padding: 1rem;">
                        <a href="{{ url_for('admin_intern_detail', intern_id=user.id) }}" class="btn" style="background: transparent; border: 1px solid var(--primary); color: var(--primary); font-size: 0.8rem;">View</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="5" style="padding: 2rem; text-align: center;">No interns found matching criteria.</td></tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}